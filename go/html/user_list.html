<div class="d-flex justify-content-between align-items-center pt-3 pb-2 mb-3 border-bottom">
    <h1 class="h3 fw-bold"><i class="fa-solid fa-users-gear me-2 text-primary"></i>用户管理</h1>
    <span class="badge bg-primary bg-opacity-10 text-primary rounded-pill px-3 py-2">{{len .}} 位用户</span>
</div>

<!-- Desktop Table View -->
<div class="table-responsive d-none d-md-block shadow-sm rounded-4 bg-white border">
    <table class="table table-hover align-middle mb-0">
        <thead class="bg-light">
            <tr class="text-uppercase small text-muted">
                <th class="ps-4 py-3">用户信息</th>
                <th>注册时间</th>
                <th>权限等级</th>
                <th class="text-end pe-4">权限设置</th>
            </tr>
        </thead>
        <tbody>
            {{range .}}
            <tr>
                <td class="ps-4">
                    <div class="d-flex align-items-center">
                        <div class="bg-primary bg-opacity-10 text-primary rounded-circle p-2 me-3" style="width: 36px; height: 36px; display: flex; align-items: center; justify-content: center;">
                            <i class="fa-solid fa-user"></i>
                        </div>
                        <span class="fw-bold text-dark">{{.Username}}</span>
                    </div>
                </td>
                <td class="text-muted small">{{.CreatedAt.Format "2006-01-02 15:04"}}</td>
                <td>
                    {{if eq .Permission 0}}<span class="badge bg-secondary">零权限</span>
                    {{else if eq .Permission 1}}<span class="badge bg-info">只读</span>
                    {{else if eq .Permission 2}}<span class="badge bg-success">读写</span>
                    {{else if eq .Permission 3}}<span class="badge bg-dark">管理员</span>
                    {{else}}<span class="badge bg-secondary">未知</span>{{end}}
                </td>
                <td class="text-end pe-4">
                    <form class="d-flex justify-content-end gap-2 align-items-center" hx-post="/user/permission" hx-target="#main-view">
                        <input type="hidden" name="username" value="{{.Username}}">
                        <select name="permission" class="form-select form-select-sm border-light bg-light" style="width: 120px;">
                            <option value="0" {{if eq .Permission 0}}selected{{end}}>零权限</option>
                            <option value="1" {{if eq .Permission 1}}selected{{end}}>只读</option>
                            <option value="2" {{if eq .Permission 2}}selected{{end}}>读写</option>
                            <option value="3" {{if eq .Permission 3}}selected{{end}}>管理员</option>
                        </select>
                        <button type="submit" class="btn btn-sm btn-icon btn-light text-primary">
                            <i class="fa-solid fa-floppy-disk"></i>
                        </button>
                    </form>
                </td>
            </tr>
            {{end}}
        </tbody>
    </table>
</div>

<!-- Mobile List View (Mimicking PC Style) -->
<div class="d-md-none">
    <div class="list-group shadow-sm rounded-4 bg-white">
        {{range .}}
        <div class="list-group-item border-0 border-bottom p-3">
            <div class="d-flex justify-content-between align-items-center mb-2">
                <div class="d-flex align-items-center">
                    <div class="bg-primary bg-opacity-10 text-primary rounded-circle me-3 d-flex align-items-center justify-content-center" style="width: 36px; height: 36px;">
                        <i class="fa-solid fa-user"></i>
                    </div>
                    <div>
                        <div class="fw-bold text-dark">{{.Username}}</div>
                        <div class="small text-muted" style="font-size: 0.75rem;">{{.CreatedAt.Format "2006-01-02"}}</div>
                    </div>
                </div>
                <div>
                    {{if eq .Permission 0}}<span class="badge bg-secondary">零权限</span>
                    {{else if eq .Permission 1}}<span class="badge bg-info">只读</span>
                    {{else if eq .Permission 2}}<span class="badge bg-success">读写</span>
                    {{else if eq .Permission 3}}<span class="badge bg-dark">管理员</span>
                    {{end}}
                </div>
            </div>
            
            <form class="d-flex gap-2 align-items-center mt-2 ps-5 ms-1" hx-post="/user/permission" hx-target="#main-view">
                <input type="hidden" name="username" value="{{.Username}}">
                <select name="permission" class="form-select form-select-sm border bg-light py-1" style="font-size: 0.85rem;">
                    <option value="0" {{if eq .Permission 0}}selected{{end}}>零权限</option>
                    <option value="1" {{if eq .Permission 1}}selected{{end}}>只读用户</option>
                    <option value="2" {{if eq .Permission 2}}selected{{end}}>读写用户</option>
                    <option value="3" {{if eq .Permission 3}}selected{{end}}>系统管理员</option>
                </select>
                <button type="submit" class="btn btn-sm btn-light text-primary border px-2">
                    <i class="fa-solid fa-floppy-disk"></i>
                </button>
            </form>
        </div>
        {{end}}
    </div>
</div>
